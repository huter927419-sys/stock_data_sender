# 如何检查日线数据是否在推送

## 方法1：查看接收程序输出

在宿主机上运行接收程序 `mq_receiver_host.py`，观察输出：

### 日线数据的特征：
- **队列名称**: `daily_data_queue`
- **记录字段**: 包含 `stock_code`, `trade_date`, `open_price`, `high_price`, `low_price`, `close_price`, `volume`, `amount`

### 示例输出：
```
[2025-12-28 22:55:10.102] ✓ 收到消息
   队列名称: daily_data_queue
   记录数量: 1151
   消息大小: 37120 字节
   第一条记录: stock_code=SH600000, trade_date=2024-01-01, close_price=12.34
   累计接收: 1 条消息, 37120 字节
```

## 方法2：查看虚拟机日志

在虚拟机的日志文件中搜索：

```bash
# 搜索日线数据相关日志
grep "日线数据" bin/Debug/Logs/StockDataMQClient_*.log
grep "daily_data_queue" bin/Debug/Logs/StockDataMQClient_*.log
grep "【MQ发送成功】.*日线数据" bin/Debug/Logs/StockDataMQClient_*.log
```

### 关键日志：
- `【MQ发送】尝试发送 X 条日线数据` - 正在尝试发送
- `【MQ发送成功】已发送 X 条日线数据` - 发送成功
- `【MQ发送失败】` - 发送失败

## 方法3：查看程序界面统计

在虚拟机程序界面中，查看 `lblMQStatus` 标签：

```
MQ同步 | 日线: 1151条 (37120) | 实时: 234条 (12345) | ...
```

如果日线数据的数字在增长，说明正在发送。

## 方法4：使用检查工具

如果收到消息但不确定是否是日线数据，可以使用检查工具：

```bash
# 将接收到的JSON保存到文件，然后检查
python check_daily_data.py message.json
```

## 常见问题

### Q1: 为什么没有收到日线数据？

**可能原因：**
1. 日线数据处理器未设置
   - 检查日志：`日线数据MQ处理器已设置`
   - 如果显示"未设置"，检查 `App.config` 中的 `MQEnabled` 是否为 `true`

2. 没有日线数据到达
   - 检查日志：`【出队】日线数据开始处理`
   - 如果没有这条日志，说明没有日线数据包到达

3. 连接失败
   - 检查日志：`【MQ连接失败】` 或 `【MQ连接超时】`
   - 确认宿主机接收程序已启动

### Q2: 如何确认日线数据正在发送？

**检查清单：**
- [ ] 日志中有 `【MQ发送】尝试发送 X 条日线数据`
- [ ] 日志中有 `【MQ连接成功】`
- [ ] 日志中有 `【MQ发送成功】已发送 X 条日线数据`
- [ ] 宿主机接收程序显示 `队列名称: daily_data_queue`
- [ ] 程序界面统计中日线数据数字在增长

### Q3: 日线数据和实时数据有什么区别？

**日线数据（daily_data_queue）：**
- 队列名称包含 `daily`
- 包含 `trade_date` 字段（交易日期）
- 包含 `open_price`, `high_price`, `low_price`, `close_price`（开高低收）
- 数据量较大，通常批量发送

**实时数据（realtime_data_queue）：**
- 队列名称包含 `realtime`
- 包含 `new_price` 字段（最新价）
- 包含 `buy_price`, `sell_price` 等实时行情字段
- 数据量较小，频繁发送

## 快速检查命令

```bash
# 在虚拟机中检查日志
grep "日线数据" bin/Debug/Logs/StockDataMQClient_*.log | tail -20

# 在宿主机中检查接收到的消息
# 观察接收程序输出中的队列名称
```

